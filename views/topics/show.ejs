<%- include('../partials/header') %>
<div class="container">
  <div class="card deep-purple lighten-3">
    <div class="card-content">
      <h1><%= title%></h1>

      <% if(!topic.goal && !topic.goalDate) { %>
      <div class="card">
        <div class="card-content">
          <form action="/topics/<%=topicId%>?_method=PUT" method="POST">

            <h2>What is your end goal with studying <%=title%></h2>
            <input type="text" name="goal">
            <h2>Do you have an end date in mind?</h2>
            <input type="date" name="goalDate">

            <button type="submit" class="btn">Submit</button>
          </form>
        </div>
      </div>
      <% } else { %>
      <h2>Goal</h2>
      <a href="/topics/<%=topicId%>/isPublic" class="btn"><%=topic.isPublic ? 'Make Private' : 'Make Public'%></a>
      <h3><%=topic.goal %></h3>
      <h2>Deadline</h2>
      <h3><%=topic.goalDate %></h3>
      <div class="card">
        <div class="card-content">
          <h2>add content</h2>
          <form action="/users/<%=user.id%>/topics/<%=topicId%>/contents" method="POST">
            <label for="addContentName">Add Name</label>
            <input type="text" name="name" id="addContentName" value="add content name">
            <label for="addContentLink">Content Link</label>
            <input type="text" name="link" id="addContentLink" value="add content link">
            <div class="input-field col s12">
              <select name="method" multiple>
                <option value="book">Book</option>
                <option value="video">Video</option>
                <option value="article">Article</option>
                <option value="online course">Online Course</option>
              </select>
            </div>
            <button type="submit" class="btn">Submit</button>
          </form>
        </div>
      </div>

      <%}%>

      <h2>Completed</h2>
      <%topic.contents.forEach(content => {%>
      <%if (content.completed) {%>
      <div class="card">
        <div class="card-content">
          <h1>Name: <%=content.name%></h1>
          <h1>Type:<%=content.method%></h1>
          <h1>Link:<%=content.link%></h1>

          <%if(content.notes === undefined){%>
          <h3>No notes to show</h3>
          <%} else {%>
          <h2>Notes:</h2>
          <div class="card" id="notes-card">
            <div class="card-content">
              <p><%=content.notes%></p>
            </div>
          </div>
          <%}%>

        </div>
      </div>
      <%}%>
          <%})%>

          <h2>In Progress</h2>
          <%topic.contents.forEach(content => {%>
          <%if(!content.completed) {%>
          <div class="card">
            <div class="card-content">
              <h1>Name: <%=content.name%></h1>
              <h1>Type:<%=content.method%></h1>
              <h1>Link:<%=content.link%></h1>

              <%if(content.notes === undefined){%>
              <h3>No notes to show</h3>
              <%} else {%>
              <h2>Notes:</h2>
              <div class="card" id="notes-card">
                <div class="card-content">
                  <p><%=content.notes%></p>
                </div>
              </div>
              <%}%>
          
          <a href="/topics/<%=topicId%>/contents/<%=content._id%>/newNote" class="btn">Add Notes</a>
              <a href="/topics/<%=topicId%>/contents/<%=content._id%>/urgent"
                class="btn"><%=content.urgent ? 'Deprioritize' : 'Proioritize'%></a>
              <a href="/topics/<%=topicId%>/contents/<%=content._id%>/completed"
                class="btn"><%=content.completed ? 'Task is completed!' : 'Complete'%></a>

              <a href="/topics/<%=topicId%>/contents/<%=content._id%>/remove" class="btn"><i
                  class="material-icons">delete_forever</i></a>
            </div>
          </div>
          <%}%>


      <% })%>
        </div>
      </div>

    </div>
    <%- include('../partials/footer') %>